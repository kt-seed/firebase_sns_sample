# Supabase ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€Anonymous SNSãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šç”¨ã®SQLãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“‹ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«

ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯**å¿…ãšé †ç•ªé€šã‚Š**ã«å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 1. `001_initial_schema.sql` - åˆæœŸã‚¹ã‚­ãƒ¼ãƒ
**æ¦‚è¦**: åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
- `users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
- `posts` - æŠ•ç¨¿
- `likes` - ã„ã„ã­
- `reposts` - ãƒªãƒã‚¹ãƒˆ
- `follows` - ãƒ•ã‚©ãƒ­ãƒ¼é–¢ä¿‚

**å®Ÿè¡Œæ–¹æ³•**:
1. Supabase Dashboard â†’ SQL Editor
2. ã€ŒNew Queryã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. `001_initial_schema.sql`ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘
4. ã€ŒRunã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 2. `002_add_indexes.sql` - ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
**æ¦‚è¦**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
- æŠ•ç¨¿ã®æ¤œç´¢é€Ÿåº¦å‘ä¸Š
- ã„ã„ã­ãƒ»ãƒªãƒã‚¹ãƒˆã®é›†è¨ˆé€Ÿåº¦å‘ä¸Š
- ãƒ•ã‚©ãƒ­ãƒ¼é–¢ä¿‚ã®æ¤œç´¢é€Ÿåº¦å‘ä¸Š

**å®Ÿè¡Œæ–¹æ³•**:
1. Supabase Dashboard â†’ SQL Editor
2. ã€ŒNew Queryã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. `002_add_indexes.sql`ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘
4. ã€ŒRunã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 3. `003_rls_policies.sql` - Row Level Security
**æ¦‚è¦**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼ã®è¨­å®š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ã¿ç·¨é›†å¯èƒ½
- èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿æŠ•ç¨¿ãƒ»ã„ã„ã­ãƒ»ãƒªãƒã‚¹ãƒˆãƒ»ãƒ•ã‚©ãƒ­ãƒ¼å¯èƒ½
- è‡ªåˆ†ãŒä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã¿å‰Šé™¤å¯èƒ½

**å®Ÿè¡Œæ–¹æ³•**:
1. Supabase Dashboard â†’ SQL Editor
2. ã€ŒNew Queryã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. `003_rls_policies.sql`ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘
4. ã€ŒRunã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 4. `004_views_and_functions.sql` - ãƒ“ãƒ¥ãƒ¼ãƒ»é–¢æ•°
**æ¦‚è¦**: ä¾¿åˆ©ãªãƒ“ãƒ¥ãƒ¼ã¨ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã®ä½œæˆ
- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ç”¨ãƒ“ãƒ¥ãƒ¼
- ã„ã„ã­ãƒ»ãƒªãƒã‚¹ãƒˆæ•°ã®å¢—æ¸›é–¢æ•°
- ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ãƒ»ãƒ•ã‚©ãƒ­ãƒ¼æ•°å–å¾—é–¢æ•°

**å®Ÿè¡Œæ–¹æ³•**:
1. Supabase Dashboard â†’ SQL Editor
2. ã€ŒNew Queryã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. `004_views_and_functions.sql`ã®å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘
4. ã€ŒRunã€ã‚’ã‚¯ãƒªãƒƒã‚¯

## âœ… å®Ÿè¡Œç¢ºèª

ã™ã¹ã¦ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

### ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¢ºèª
Supabase Dashboard â†’ Table Editor ã§ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š
- âœ… users
- âœ… posts
- âœ… likes
- âœ… reposts
- âœ… follows

### RLSã®ç¢ºèª
å„ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã€ŒRLS enabledã€ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

### é–¢æ•°ã®ç¢ºèª
Supabase Dashboard â†’ Database â†’ Functions ã§ä»¥ä¸‹ã®é–¢æ•°ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š
- âœ… increment_likes_count
- âœ… decrement_likes_count
- âœ… increment_reposts_count
- âœ… decrement_reposts_count
- âœ… get_followers_count
- âœ… get_following_count
- âœ… user_liked_posts

## ğŸ”„ Realtimeæœ‰åŠ¹åŒ–

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§Realtimeã‚’æœ‰åŠ¹åŒ–ã—ã¦ãã ã•ã„ï¼š

1. Supabase Dashboard â†’ Database â†’ Replication
2. ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®Realtimeã‚’æœ‰åŠ¹åŒ–ï¼š
   - âœ… posts
   - âœ… likes
   - âœ… reposts
   - âœ… follows

## ğŸ” Authenticationè¨­å®š

1. Supabase Dashboard â†’ Authentication â†’ Providers
2. Email Providerã®è¨­å®šã‚’ç¢ºèªãƒ»å¤‰æ›´ï¼š
   - **Enable Email provider**: ON
   - **Confirm email**: **OFF**ï¼ˆé‡è¦ï¼ï¼‰
   - **Secure email change**: ON

## ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

é–‹ç™ºç”¨ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ãŸã„å ´åˆã¯ã€ä»¥ä¸‹ã®SQLã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

```sql
-- ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆï¼ˆã¾ãšSupabase Authã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¦ã‹ã‚‰å®Ÿè¡Œï¼‰
-- æ³¨æ„: ã“ã®ä¾‹ã®UUIDã¯å®Ÿéš›ã®auth.usersã®IDã«ç½®ãæ›ãˆã¦ãã ã•ã„

-- ãƒ†ã‚¹ãƒˆæŠ•ç¨¿
INSERT INTO posts (user_id, text) VALUES
  ('your-user-id-here', 'ã“ã‚Œã¯æœ€åˆã®ãƒ†ã‚¹ãƒˆæŠ•ç¨¿ã§ã™ï¼'),
  ('your-user-id-here', 'Supabase + Vue.jsã§SNSã‚’ä½œã£ã¦ã„ã¾ã™ã€‚');
```

## ğŸ“š å‚è€ƒè³‡æ–™

- [Supabaseå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://supabase.com/docs)
- [PostgreSQL RLS](https://supabase.com/docs/guides/auth/row-level-security)
- [Supabase Realtime](https://supabase.com/docs/guides/realtime)
